<!-- Main Content Section -->
<div class="list-content listmap-grid">
  <div class="container-fluid">

    <div class="row">

      <div class="col-lg-6 grid-view listgrid-sidebar mt-5 ">
        <div class="listingmappage-content car-filter-section  mt-5 mb-2">               
                  <ul class="nav nav-pills mb-1" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                      <button
                        class="nav-link active"
                        id="pills-home-tab"
                        data-bs-toggle="pill"
                        data-bs-target="#pills-home"
                        type="button"
                        role="tab"
                        aria-controls="pills-home"
                        aria-selected="true"
                      >
                        Trouver un bien
                      </button>
                    </li>
                  </ul>
                  <div class="tab-content" id="pills-tabContent">
                    <div
                      class="tab-pane fade show active"
                      id="pills-home"
                      role="tabpanel"
                      aria-labelledby="pills-home-tab"
                      tabindex="0"
                    >
                      <div class="search-tab-col">
                        <form (ngSubmit)="onSubmit(f)" #f="ngForm">
                          <div class="row align-items-center search-form">
                            <div class="col-12 col-lg-12 search-group">
                              <div class="row">
                                <div class="  col-xl-4">
                                  <div class="d-flex real-estate-search">
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <i class="feather-map-pin"></i>
                                      </div>
                                    </div>
    
                                   
                                    <div class="flex-grow-1 ms-3">
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 98%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''"
                                          >Region</mat-label
                                        >
                                        <mat-select
                                          name="region"
                                          (selectionChange)="onChangeRegion($event);updateUrl()"
                                        >
                                          <mat-option
                                            *ngFor="let Region of region"
                                            [value]="Region.nomregion"
                                          >
                                            {{ Region?.nomregion }}</mat-option
                                          >
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
                                <div class=" col-xl-4">
                                  <div class="d-flex real-estate-search">
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <i class="feather-map-pin"></i>
                                      </div>
                                    </div>
                                   
                                    <div class="flex-grow-1 ms-3">
    
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 100%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''"
                                          >Cercle</mat-label
                                        >
                                        <mat-select
                                          name="cercle"
                                          (selectionChange)="onChangeCercle($event); updateUrl()"
                               
                                        >
                                          <mat-option
                                            *ngFor="let Cercle of cercles"
                                            [value]="Cercle.id"
                                            >{{ Cercle?.nomcercle }}</mat-option
                                          >
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
                                <div class=" col-xl-4">
                                  <div class="d-flex real-estate-search">
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <i class="feather-map-pin"></i>
                                      </div>
                                    </div>
                                   
                                    <div class="flex-grow-1 ms-3">
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 100%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''">
                                          Commune</mat-label
                                        >
                                        <mat-select
                                          name="commune"
                                          [(ngModel)]="form.commune" (selectionChange)="updateUrl()"
                                        >
                                                   <mat-option
                                            *ngFor="let Commune of communes1"
                                            [value]="Commune.id"
                                            >{{ Commune?.nomcommune }}</mat-option
                                          >
                                                 
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
                                <div class=" col-xl-4">
                                  <div
                                    class="d-flex real-estate-search real-select"
                                  >
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <img
                                          style="width: 20px"
                                          src="./assets/img/icons/fax-icon.png"
                                          alt=""
                                        />
                                      </div>
                                    </div>
                                    
                                    <div class="flex-grow-1 ms-3">
                                      <mat-form-field class="mat-custom-select" style="width: 100%">
                                        <mat-label *ngIf="selectedCategory == ''">Statut</mat-label>
                                        <mat-select [(ngModel)]="form.statut" name="statut" (selectionChange)="onStatutChange($event); ">
                                          <mat-option *ngFor="let Statut of status" [value]="Statut.id">
                                            {{ Statut?.nom }}
                                          </mat-option>
                                        </mat-select>
                                      </mat-form-field>
                                      
                                    </div>
                                  </div>
                                </div>
    
                                <div class=" col-xl-4">
                                  <div class="d-flex real-estate-search">
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <i class="feather-home"></i>
                                      </div>
                                    </div>
    
                                   
                                    <div class="flex-grow-1 ms-3">
                                     
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 100%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''">
                                          Type</mat-label
                                        >
                                        <mat-select
                                          [(ngModel)]="form.type"
                                          name="type" (selectionChange)="updateUrl()"
                                        >
                                          <mat-option
                                            *ngFor="let Type of typebien"
                                            [value]="Type.id"
                                          >
                                            {{ Type?.nom }}</mat-option
                                          >
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
                                <div class=" col-xl-4">
                                  <div class="d-flex real-estate-search">
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <img
                                          src="./assets/img/icons/bed-icon.svg"
                                          alt=""
                                        />
                                      </div>
                                    </div>
                                    
                                    <div class="flex-grow-1 ms-3">
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 100%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''">
                                          Chambres</mat-label
                                        >
                                        <mat-select
                                          [(ngModel)]="form.chambre"
                                          name="chambre" (selectionChange)="updateUrl()"
                                        >
                                          <mat-option
                                            *ngFor="let item of valuesSelect"
                                            [value]="item"
                                          >
                                            {{ item }}</mat-option
                                          >
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
                    
                            
                                <div class="col-xl-4">
                                  <div
                                    class="d-flex real-estate-search real-select"
                                  >
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <img
                                          src="./assets/img/icons/area-icon.svg"
                                          alt=""
                                        />
                                      </div>
                                    </div>
                                    
    
                                    <div class="flex-grow-1 ms-3">
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 100%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''">
                                          Nombre de salon</mat-label
                                        >
                                        <mat-select
                                          [(ngModel)]="form.nb_piece"
                                          name="nb_piece"
                                          (selectionChange)="updateUrl()"
                                        >
                                          <mat-option
                                            *ngFor="let item of valuesSelect"
                                            [value]="item"
                                          >
                                            {{ item }}</mat-option
                                          >
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
    
                                <div class=" col-xl-4">
                                  <div
                                    class="d-flex real-estate-search real-select"
                                  >
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <img
                                          src="./assets/img/icons/bath-icon.svg"
                                          alt=""
                                        />
                                      </div>
                                    </div>
                                    
                                    <div class="flex-grow-1 ms-3">
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 100%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''">
                                          Toilette</mat-label
                                        >
                                        <mat-select
                                          [(ngModel)]="form.toilette"
                                          name="toilette"
                                          (selectionChange)="updateUrl()"
                                        >
                                          <mat-option
                                            *ngFor="let item of valuesSelect"
                                            [value]="item"
                                          >
                                            {{ item }}</mat-option
                                          >
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
                                <div class=" col-xl-4">
                                  <div
                                    class="d-flex real-estate-search real-select"
                                  >
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <img
                                          style="width: 20px"
                                          src="./assets/img/icons/649395.png"
                                          alt=""
                                        />
                                      </div>
                                    </div>
                                  
                                    <div class="flex-grow-1 ms-3">
                           
                                      <mat-form-field
                                        class="mat-custom-select"
                                        style="width: 100%"
                                      >
                                        <mat-label *ngIf="selectedCategory == ''">
                                          Cuisines</mat-label
                                        >
                                        <mat-select
                                          [(ngModel)]="form.cuisine"
                                          name="cuisine"
                                          (selectionChange)="updateUrl()"
                                        >
                                          <mat-option
                                            *ngFor="let item of valuesSelect"
                                            [value]="item"
                                          >
                                            {{ item }}</mat-option
                                          >
                                        </mat-select>
                                      </mat-form-field>
                                    </div>
                                  </div>
                                </div>
                                <div class=" col-xl-8 mt-2 ">
                                  <div class="d-flex w-100 ">
                                    <div
                                      class="flex-shrink-0 d-flex align-items-center"
                                    >
                                      <div class="icon-blk rounded-circle">
                                        <img
                                          style="width: 30px"
                                          src="./assets/img/icons/prix.jpg"
                                          alt=""
                                        />
                                      </div>
                                    </div>
                                    &nbsp; &nbsp;
                                    <div class="monslider ">
                                      <ng5-slider
                                        [(value)]="customHtmlMinValue"
                                        (valueChange)="updateMinPrice()"
                                        [(highValue)]="customHtmlMaxValue"
                                        (highValueChange)="updateMaxPrice()"
                                        [options]="customHtmlSliderOptions"
                                      ></ng5-slider>
                                    </div>
                                  </div>
                                </div>
    
    
                                <div class=" col-xl-4 flex-grow-1 mb-5">
                                  <div class="">
                                    <p>
                                   <a
                                        class="row mt-3 fw-bold"
                                        data-bs-toggle="collapse"
                                        href="#cautrecomm"
                                        role="button"
                                        aria-expanded="false"
                                        aria-controls="collapseExample"
                                      >
                                        Autres commodites
                                      </a>
                                    </p>
                                  </div>
                                </div>
                                <div class="collapse   mt-2" id="cautrecomm" >
                                  <div class="">
                                    <div class="row">
                                      <div class="col-md-3" *ngFor="let Commodite of commodite; let i = index">
                                        <div class="form-check mb-2">
                                          <input
                                            class="form-check-input"
                                            type="checkbox"
                                            [(ngModel)]="Commodite.selected"
                                            [value]="Commodite.id"
                                            [id]="'flexCheckDefault' + i"
                                            (change)="onChangeCommodite()"
                                            name="commodite"
                                            (change)="updateUrl()"
                                          />
                                          <label
                                            class="form-check-label"
                                            [for]="'flexCheckDefault' + i"
                                          >
                                            {{ Commodite?.nom }}
                                          </label>
                                        </div>
                                      </div>
                                    </div>
                                    
                                  </div>
                                </div>

                              </div>
                            </div>
                           
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
             
            </div>
        <div class="row">
          <!-- <ng-template #loadedContent> -->
          <ng-container *ngIf="bienImmo && bienImmo.length > 0; else noBiens">
            <div class="col-lg-6 col-md-4"
              *ngFor="let BienImo of bienImmo | filter : searchText">
              <div class="card">
                <div class="blog-widget">
                  <div class="blog-img">
                    <a (click)="goToDettailBien(BienImo?.uuid)" class="crd">
                      <div *ngIf="BienImo?.photos; else noImages">
                        <img src="{{ generateImageUrl(BienImo?.photos) }}" class="img-fluid image-size"
                          alt="blog-img">
                      </div>
                      <ng-template #noImages>
                        <div class="type" *ngIf="BienImo?.typeImmo?.nom === 'Villa'">
                          <img src="../../../../assets/img/typebien/villa.png" class="img-fluid image-size"
                            alt="default-img">
                        </div>
                        <div class="type" *ngIf="BienImo?.typeImmo?.nom === 'Appartement'">
                          <img src="../../../../assets/img/typebien/appartement.png" class="img-fluid image-size"
                            alt="default-img">
                        </div>
                        <div class="type" *ngIf="BienImo?.typeImmo?.nom === 'Terrain'">
                          <img src="../../../../assets/img/typebien/terrain.png" class="img-fluid image-size"
                            alt="default-img">
                        </div>
                        <div class="type" *ngIf="BienImo?.typeImmo?.nom === 'Bureau'">
                          <img src="../../../../assets/img/typebien/bureau.png" class="img-fluid image-size"
                            alt="default-img">
                        </div>
                        <div class="type" *ngIf="BienImo?.typeImmo?.nom === 'Champ'">
                          <img src="../../../../assets/img/typebien/champ.png" class="img-fluid image-size"
                            alt="default-img">
                        </div>
                        <div class="type" *ngIf="BienImo?.typeImmo?.nom === 'Commerce & Magasin'">
                          <img src="../../../../assets/img/typebien/magasin.png" class="img-fluid image-size"
                            alt="default-img">
                        </div>
                      </ng-template>
                    </a>
                    <div class="fav-item">
                      <span [ngClass]="{'statutbien': BienImo?.statut?.nom === 'A vendre' }" class="Featured-text">{{
                        BienImo?.statut?.nom }}</span>
                      <a href="javascript:void(0)" *ngIf="isLoggedIn == true " class="fav-icon"
                        (click)="AimerBien(BienImo?.uuid)"
                        [style.background-color]="favoriteStatus[BienImo?.uuid] ? '#e98b11' : 'white'">
                        <i [style.color]="favoriteStatus[BienImo?.uuid] ? 'white' : 'black'" class="feather-heart"></i>
                      </a>
                    </div>
                  </div>
                  <!-- Block level -->

                  <div class="bloglist-content">
                    <div class="card-body">
                      <div class="blogfeaturelink">
                        <div class="grid-author">
                          <img src="{{generateImageUrl(BienImo?.utilisateur?.photo)}}" alt="author"
                            (error)="handleAuthorImageError($event)" />
                        </div>
                        <div class="blog-features">
                          <a href="javascript:void(0)"><span>
                              <i class="fa-regular fa-circle-stop"></i>
                              {{ BienImo?.typeImmo?.nom }}</span></a>
                        </div>
                        <div class="blog-author text-end">
                          <span>
                            <i class="feather-eye"></i>{{ favoritedPropertiesCount1[BienImo?.uuid] }}
                            <!-- <i class="feather-eye"></i>{{ BienImo?.favoris?.length }} -->
                          </span>
                        </div>
                      </div>
                      <h6 class="crd">
                        <a (click)="goToDettailBien(BienImo?.uuid)">{{ BienImo?.nom ? BienImo?.nom : BienImo?.typeImmo?.nom
                          }}</a>
                      </h6>
                      <div class="blog-location-details">
                        <div class="location-info">
                          <i class="feather-map-pin"></i> {{ BienImo?.adresse?.quartier }}
                        </div>
                        <div class="location-info">
                          <i class="fa-solid fa-calendar-days"></i>{{BienImo?.createdAt | date:"dd MMM yyyy":locale}}

                        </div>
                      </div>
                      <div class="amount-details">
                        <div class="amount">
                          <span class="validrate">{{ formatPrice(BienImo?.prix) }} FCFA</span>
                          <!--<span>{{ slide.oldamount }}</span>-->
                        </div>
                        <div class="ratings">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-template #noBiens>
            <div class="row Pblog" style="margin-left: auto !important;
            margin-right: auto !important;">
              <div class="col-lg-6 col-md-4" aria-hidden="true">
                <div class="card">
                  <div class="blog-widget placeholder-glow">
                    <div class="blog-img">
                      <a>
                        <div>
                          <img src="assets/img/test.jpg" class="img-fluid image-size" alt="blog-img">
                        </div>
                      </a>
                      <div class="fav-item placeholder-glow">
                        <span class="placeholder">hhhhhh</span>
                        <a href="javascript:void(0)" class="fav-icon placeholder">
                        </a>
                      </div>
                    </div>
                    <div class="bloglist-content placeholder-glow">
                      <div class="card-body">
                        <div class="blogfeaturelink">
                          <div class="grid-author placeholder">
                            <img class="placeholder" alt="author" />
                          </div>
                          <div class="blog-features placeholder-glow">
                            <a href="javascript:void(0)"><span class="placeholder">
                                jjjjjjjjjjjjjjj</span></a>
                          </div>
                          <div class="blog-author text-end placeholder-glow">
                            <span class="placeholder">jjjjljjjjjjjjjjjl
                            </span>
                          </div>
                        </div>
                        <div class="blog-location-details placeholder-glow">
                          <div class="location-info placeholder">aaaaaaaaaaaa
                          </div>
                        </div>
                        <div class="blog-location-details placeholder-glow">
                          <div class="location-info placeholder">aaaaaaaaaaaaaaaaa
                          </div>
                          <div class="location-info placeholder">aaaaaaaaaaaaaa
                          </div>
                        </div>
                        <div class="amount-details placeholder-glow">
                          <div class="amount">
                            <span class="placeholder">aaaaaaaaaaaaaaaaa</span>
                          </div>
                          <div class="ratings">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-lg-6 col-md-4" aria-hidden="true">
                <div class="card">
                  <div class="blog-widget placeholder-glow">
                    <div class="blog-img">
                      <a>
                        <div>
                          <img src="assets/img/test.jpg" class="img-fluid image-size" alt="blog-img">
                        </div>
                      </a>
                      <div class="fav-item placeholder-glow">
                        <span class="placeholder">hhhhhh</span>
                        <a href="javascript:void(0)" class="fav-icon placeholder">
                        </a>
                      </div>
                    </div>
                    <div class="bloglist-content placeholder-glow">
                      <div class="card-body">
                        <div class="blogfeaturelink">
                          <div class="grid-author placeholder">
                            <img class="placeholder" alt="author" />
                          </div>
                          <div class="blog-features placeholder-glow">
                            <a href="javascript:void(0)"><span class="placeholder">
                                jjjjjjjjjjjjjjj</span></a>
                          </div>
                          <div class="blog-author text-end placeholder-glow">
                            <span class="placeholder">jjjjljjjjjjjjjjjl
                            </span>
                          </div>
                        </div>
                        <div class="blog-location-details placeholder-glow">
                          <div class="location-info placeholder">aaaaaaaaaaaa
                          </div>
                        </div>
                        <div class="blog-location-details placeholder-glow">
                          <div class="location-info placeholder">aaaaaaaaaaaaaaaaa
                          </div>
                          <div class="location-info placeholder">aaaaaaaaaaaaaa
                          </div>
                        </div>
                        <div class="amount-details placeholder-glow">
                          <div class="amount">
                            <span class="placeholder">aaaaaaaaaaaaaaaaa</span>
                          </div>
                          <div class="ratings">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
          <!-- </ng-template> -->
        </div>
      </div>
      
      <div class="col-lg-6 map-right">
        <!-- <app-list-map></app-list-map> -->
        <!-- <div id="map" class="map-listing" *ngIf="userPosition">
          <p-gmap [options]="options"
            [overlays]="overlays | filterMarkersByCriteria: searchText:selectedRegion:selectedCommune:selectedType"
            (onOverlayClick)="setInfo($event)" [style]="{ width: '100%', height: '100%' }"></p-gmap>
        </div> -->
        <div id="map" style="width: 98%"></div>
        <!-- <div class="map-wrapper">
          <div class="map-border">
            <div id="map"></div>
          </div>
        </div> -->

        <!-- <div class="map-container">
          <div class="map-frame">
            <div id="map" style="width: 100%; height: 400px;"></div>
          </div>
        </div> -->
      </div>
      <!-- <div class="col-lg-12">
        <app-map></app-map>
      </div> -->
    </div>
  </div>
</div>
<!-- /Main Content Section -->
